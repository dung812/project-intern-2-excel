@using System.Data
@model DataSet

<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>Index</title>
    <style>
        .input-file-container {
            position: relative;
            width: 225px;
        }

        .js .input-file-trigger {
            display: block;
            padding: 14px 45px;
            background: #39D2B4;
            color: #fff;
            font-size: 1em;
            transition: all .4s;
            cursor: pointer;
        }

        .js .input-file {
            position: absolute;
            top: 0;
            left: 0;
            width: 225px;
            opacity: 0;
            padding: 14px 0;
            cursor: pointer;
        }

            .js .input-file:hover + .input-file-trigger,
            .js .input-file:focus + .input-file-trigger,
            .js .input-file-trigger:hover,
            .js .input-file-trigger:focus {
                background: #34495E;
                color: #39D2B4;
            }

        .file-return {
            margin: 0;
        }

            .file-return:not(:empty) {
                margin: 1em 0;
            }

        .js .file-return {
            font-style: italic;
            font-size: .9em;
            font-weight: bold;
        }

            .js .file-return:not(:empty):before {
                content: "Selected file: ";
                font-style: normal;
                font-weight: normal;
            }
        /* Useless styles, just for demo styles */

        body {
            font-family: "Open sans", "Segoe UI", "Segoe WP", Helvetica, Arial, sans-serif;
            color: #7F8C9A;
            background: #FCFDFD;
        }

        h1, h2 {
            margin-bottom: 5px;
            font-weight: normal;
            text-align: center;
            color: #aaa;
        }

        h2 {
            margin: 5px 0 2em;
            color: #1ABC9C;
        }

        form {
            width: 225px;
            margin: 0 auto;
            text-align: center;
        }

        h2 + P {
            text-align: center;
        }

        .txtcenter {
            margin-top: 4em;
            font-size: .9em;
            text-align: center;
            color: #aaa;
        }

        .copy {
            margin-top: 2em;
        }

            .copy a {
                text-decoration: none;
                color: #1ABC9C;
            }

        .btn-submit {
            margin-top: 1rem;
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 0px;
            background-color: #333;
            color: #f5f5f5;
            font-size: 16px;
            width: 155px;
            background-color: #ff4d0d;
            color: #fff;
            cursor: pointer;
        }

            .btn-submit:hover {
                opacity: 0.8;
            }

        .success-alert {
            color: red;
        }
    </style>
</head>
<body>
    <h1>Import data of Uploaded Excel into Database</h1>
    <h2>Import your Excel file</h2>

    <form method="post" enctype="multipart/form-data">
        <div class="input-file-container">
            <input class="input-file" id="my-file" name="file" type="file" required />
            <label tabindex="0" for="my-file" class="input-file-trigger">Select a file...</label>
            <p class="file-return"></p>
            <button type="submit" class="btn-submit">UPLOAD!</button>
            <h1 class="success-alert">@ViewBag.SuccessUpload</h1>
        </div>
    </form>

    @if (Model != null)
    {
        <table cellpadding="0" cellspacing="10" style="margin: 0 auto;">
            <tr>
                @foreach (DataColumn col in Model.Tables[0].Columns)
                {
                    <th align="center">@col.ColumnName</th>
                }
            </tr>
            @foreach (DataRow row in Model.Tables[0].Rows)
                {
                    <tr>
                        @foreach(DataColumn col in Model.Tables[0].Columns)
                    {
                        <td align="center">@row[col.ColumnName]</td>
                    }
                    </tr>
                }
        </table>
    }

    <script>
        document.querySelector("html").classList.add('js');

        var fileInput = document.querySelector(".input-file"),
            button = document.querySelector(".input-file-trigger"),
            the_return = document.querySelector(".file-return");

        button.addEventListener("keydown", function (event) {
            if (event.keyCode == 13 || event.keyCode == 32) {
                fileInput.focus();
            }
        });
        button.addEventListener("click", function (event) {
            fileInput.focus();
            return false;
        });
        fileInput.addEventListener("change", function (event) {
            the_return.innerHTML = this.value;
        });
    </script>
</body>
</html>